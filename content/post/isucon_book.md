---
title: 『達人が教えるWebパフォーマンスチューニング』を読んでいる
date: 2023-05-26T09:29:20+09:00
draft: false
tags: ["book"]
images: ["images/articles/avatar.png"]
description: 
---

まだ読み切っていないので、追記していく予定。

### 『達人が教えるWebパフォーマンスチューニング』概要

章立ては以下の通り。

- Chapter 1　チューニングの基礎知識
- Chapter 2　モニタリング
- Chapter 3　基礎的な負荷試験
- Chapter 4　シナリオを持った負荷試験
- Chapter 5　データベースのチューニング
- Chapter 6　リバースプロキシの利用
- Chapter 7　キャッシュの活用
- Chapter 8　押さえておきたい高速化手法
- Chapter 9　OSの基礎知識とチューニング

概要については下記のポストにまとめられている。

- [【書評】「達人が教えるWebパフォーマンスチューニング」 Webアプリケーションのパフォーマンスを出すための指針を教えてくれる本](https://dev.classmethod.jp/articles/220609_book_web_performance_tunning/)
- [「達人が教える Webパフォーマンスチューニング ~ISUCONから学ぶ高速化の実践」レビュー](https://qiita.com/chibiegg/items/b82cfc4bbd33e14890a7)

2章までは基礎知識・理論で、3章からは実践的な内容になっている。
[理論の部分についての補足・批判が入った読書メモを@ymotongpooさんがまとめてくれていて](ymotongpoo)、こちらも参考になる。

感想の中に、全体的にクラシックな構成（サーバーにSSHしてLinuxコマンドを叩くなど）であるというものがあった。確かにそうだと思う。学校など教育機関で学んだ人は、クラシックな構成は触り慣れているので、コンテナなどモダンな環境の実践から入りたいかもしれない。

しかし、自分は正規の教育を受けたことがなかったので、いわゆるクラシックな構成を前提にポイントを絞ったシンプルな解説をしている本書の構成が良かった。

仕事でもまだオンプレサーバーを触る機会はあるし、自分の場合こういったパフォーマンスモニタリングは苦しみがら実践で覚えるしかなかったので（知識にムラも出るし作業が危険だし効率が悪い）、本書のようにハンズオン環境を用意して解説してくれる本はありがたい。コンテナにはコンテナの考え方があり、クラシックな環境とは覚えることが異なるが、コンテナ時代にもクラシックな環境で学んだ考え方は役に立つと感じている。そして、学ぶときの構成はできるだけシンプルな方が初学者にはわかりやすくてよい。

3章から著者の一人である @catatsuyさんの[private-isu](https://github.com/catatsuy/private-isu)を利用して実際にパフォーマンスチューニングを手を動かしながら学ぶ。このうち、自分が参考になったと思うことをメモしていく。

### Chapter 3　基礎的な負荷試験　メモ

Nginxのログのうち、パフォーマンス観点から注目すべきものがいくつかある。
パフォーマンスを改善するとわかりやすく変化数値としては、レイテンシとスループットの2つがある。

- Time per requests（レスポンスタイム・レイテンシ
  - 1リクエストの処理にかかる時間
- Request per seconds（スループット）
  - 1秒間に処理できたリクエスト数

ツールを使って負荷をかけベンチマークを取る際、まずレイテンシに注目するとわかりやすい。しかし、レイテンシは削減していくと利用者の体幹に変化がなくなる（10ms以下の違いは利用者にはわからない）。
そこで、スループットが実運用において重要な指標となる。多数のリクエストが発生した場合に利用者の体感に影響するためである。

レイテンシとスループットは反比例の関係になるが、レイテンシの短縮には限界があり、それだけではスループットは向上しない。スループットの向上のためには、レイテンシの短縮と同時に、他の処理の最適化が必要になる。

WIP
